# æ ‡å‡†èµ„æºæ¨¡å—å¼€å‘æ–‡æ¡£

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

æ ‡å‡†èµ„æºæ¨¡å—(`newbie-standard`)æ˜¯NewbieBoot3ä¼ä¸šç®¡ç†ç³»ç»Ÿä¸­çš„æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼Œä¸“é—¨ç”¨äºç®¡ç†å„ç±»æ ‡å‡†åŒ–æ–‡æ¡£èµ„æºã€‚è¯¥æ¨¡å—æä¾›äº†å®Œæ•´çš„æ ‡å‡†èµ„æºç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ ‡å‡†ä¿¡æ¯ç®¡ç†ã€é™„ä»¶ç®¡ç†ã€æœ¯è¯­å®šä¹‰ã€å¼•ç”¨å…³ç³»å’Œè§£è¯»æ–‡æ¡£ç­‰ã€‚

## ğŸ—ï¸ æ¨¡å—æ¶æ„

### æ ¸å¿ƒç»„ä»¶
- **å®ä½“å±‚(Entity)**: 5ä¸ªæ ¸å¿ƒä¸šåŠ¡å®ä½“
- **æ•°æ®è®¿é—®å±‚(Mapper)**: MyBatis-Plusæ˜ å°„å™¨ + è‡ªå®šä¹‰XMLæ˜ å°„
- **æœåŠ¡å±‚(Service)**: ä¸šåŠ¡é€»è¾‘å®ç°
- **æ§åˆ¶å™¨å±‚(Controller)**: RESTful APIæ¥å£

### æ¨¡å—ä¾èµ–
```
newbie-standard
â””â”€â”€ newbie-common (åŸºç¡€æ¨¡å—)
    â”œâ”€â”€ MyBatis-Plusé…ç½®
    â”œâ”€â”€ Redisç¼“å­˜é…ç½®  
    â”œâ”€â”€ ç»Ÿä¸€å“åº”æ ¼å¼
    â””â”€â”€ åŸºç¡€å®ä½“ç±»
```

## ğŸ“Š æ•°æ®æ¨¡å‹è®¾è®¡

### 1. æ ‡å‡†èµ„æºä¸»è¡¨ (std_resource)
**æ ¸å¿ƒå®ä½“**: `StdResource.java`

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| resourceCode | String | æ ‡å‡†ç¼–å· | GB/T 14396-2016 |
| chineseName | String | ä¸­æ–‡åç§° | ç–¾ç—…åˆ†ç±»ä¸ä»£ç  |
| englishName | String | è‹±æ–‡åç§° | Disease Classification and Codes |
| standardStatus | String | æ ‡å‡†çŠ¶æ€ | ç°è¡Œ/åºŸæ­¢/å³å°†å®æ–½/è¢«ä»£æ›¿ |
| standardType | String | æ ‡å‡†ç±»å‹ | å›½å®¶æ ‡å‡†/è¡Œä¸šæ ‡å‡†/åœ°æ–¹æ ‡å‡† |
| standardNature | String | æ ‡å‡†æ€§è´¨ | å¼ºåˆ¶æ€§/æ¨èæ€§/æŒ‡å¯¼æ€§æŠ€æœ¯æ–‡ä»¶ |
| publishOrganization | String | å‘å¸ƒæœºæ„ | å›½å®¶å«ç”Ÿå¥åº·å§”å‘˜ä¼š |
| standardField | String | æ ‡å‡†é¢†åŸŸ | åŒ»ç–—/åŒ»ä¿/åŒ»è¯/å…¬å«/åŒ»å…»/å…¶ä»– |
| standardClassification | String | æ ‡å‡†åˆ†ç±» | åˆ†ç±»ä¸ç¼–ç /æœ¯è¯­/æ•°æ®å…ƒ/æ¥å£è§„èŒƒ |

### 2. æ ‡å‡†èµ„æºé™„ä»¶è¡¨ (std_resource_attachment)  
**æ ¸å¿ƒå®ä½“**: `StdResourceAttachment.java`

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| resourceId | String | å…³è”èµ„æºID | å¤–é”®å…³è” |
| attachmentName | String | é™„ä»¶åç§° | GBT14396-2016ç–¾ç—…åˆ†ç±»ä¸ä»£ç .pdf |
| attachmentType | String | é™„ä»¶ç±»å‹ | PDFæ–‡æ¡£/å›¾ç‰‡/è¡¨æ ¼/å‹ç¼©åŒ… |
| fileSize | String | æ–‡ä»¶å¤§å° | 54.36 MB |
| isMainFile | Boolean | æ˜¯å¦ä¸»æ–‡ä»¶ | true/false |
| downloadUrl | String | ä¸‹è½½é“¾æ¥ | MinIOå­˜å‚¨è·¯å¾„ |

### 3. æœ¯è¯­å®šä¹‰è¡¨ (std_terminology)
**æ ¸å¿ƒå®ä½“**: `StdTerminology.java`

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| resourceId | String | å…³è”èµ„æºID | å¤–é”®å…³è” |
| termName | String | æœ¯è¯­åç§° | åŸºæœ¬æ•°æ®é›† |
| englishTerm | String | è‹±æ–‡å¯¹åº”è¯ | Basic dataset |
| definition | String | æœ¯è¯­å®šä¹‰ | è¯¦ç»†å®šä¹‰å†…å®¹ |
| termCategory | String | æœ¯è¯­åˆ†ç±» | æŒ‰ä¸šåŠ¡åˆ†ç±» |
| sortOrder | Integer | æ’åºå­—æ®µ | æ˜¾ç¤ºé¡ºåº |

### 4. æ ‡å‡†èµ„æºå¼•ç”¨å…³è”è¡¨ (std_resource_reference)
**æ ¸å¿ƒå®ä½“**: `StdResourceReference.java`

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| resourceId | String | æ ‡å‡†èµ„æºID | å½“å‰æ ‡å‡† |
| referenceId | String | å¼•ç”¨æ–‡ä»¶ID | è¢«å¼•ç”¨æ ‡å‡† |
| referenceType | String | å¼•ç”¨ç±»å‹ | å¼•ç”¨/è¢«å¼•ç”¨ |
| referenceName | String | å¼•ç”¨æ–‡ä»¶å | WS 363.1 å«ç”Ÿä¿¡æ¯æ•°æ®å…ƒç›®å½• |
| sortOrder | Integer | å¼•ç”¨æ’åº | æ˜¾ç¤ºé¡ºåº |

### 5. æ–‡ä»¶è§£è¯»ä¿¡æ¯è¡¨ (std_interpretation)
**æ ¸å¿ƒå®ä½“**: `StdInterpretation.java`

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| resourceId | String | å…³è”èµ„æºID | å¤–é”®å…³è” |
| sourceType | String | æ¥æºç±»å‹ | æ–‡ä»¶/ç½‘ç«™ |
| sourceTitle | String | è§£è¯»æ ‡é¢˜ | ã€Šç–¾ç—…æ§åˆ¶åŸºæœ¬æ•°æ®é›†ã€‹æ ‡å‡†è§£è¯» |
| sourceUrl | String | è§£è¯»é“¾æ¥ | ä¸‹è½½é“¾æ¥æˆ–å®˜æ–¹ç½‘å€ |
| isOfficial | Boolean | æ˜¯å¦å®˜æ–¹è§£è¯» | true/false |
| viewCount | Integer | æŸ¥çœ‹æ¬¡æ•° | ç»Ÿè®¡æ•°æ® |

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. æ•°æ®è®¿é—®å±‚ (Mapper)

#### è‡ªå®šä¹‰æŸ¥è¯¢æ–¹æ³•
**StdResourceMapper.java**
```java
// æ ¹æ®æ ‡å‡†ç¼–å·æŸ¥è¯¢
StdResource selectByResourceCode(@Param("resourceCode") String resourceCode);

// æ ¹æ®çŠ¶æ€æŸ¥è¯¢
List<StdResource> selectByStatus(@Param("standardStatus") String standardStatus);

// å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢
List<StdResource> selectByConditions(@Param("resource") StdResource resource);
```

**StdInterpretationMapper.java**  
```java
// æ ¹æ®èµ„æºIDæŸ¥è¯¢è§£è¯»åˆ—è¡¨
List<StdInterpretation> selectByResourceId(@Param("resourceId") String resourceId);

// æŸ¥è¯¢å®˜æ–¹è§£è¯»
List<StdInterpretation> selectOfficialByResourceId(@Param("resourceId") String resourceId);

// æ›´æ–°æŸ¥çœ‹æ¬¡æ•°
void incrementViewCount(@Param("id") String id);
```

#### XMLæ˜ å°„æ–‡ä»¶ç‰¹æ€§
- **æ¡ä»¶æŸ¥è¯¢**: ä½¿ç”¨`<if>`æ ‡ç­¾å®ç°åŠ¨æ€SQL
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ’å…¥å’Œæ›´æ–°
- **å…³è”æŸ¥è¯¢**: å¤–é”®å…³ç³»ç»´æŠ¤å’Œçº§è”æ“ä½œ
- **æ’åºæœºåˆ¶**: å¤šå­—æ®µæ’åºæ”¯æŒ

### 2. æœåŠ¡å±‚ (Service)

#### æ ‡å‡†èµ„æºç®¡ç†æœåŠ¡
**StdResourceService.java**
```java
// åŸºç¡€CRUDæ“ä½œ
StdResource getById(String id);
boolean save(StdResource stdResource);
boolean updateById(StdResource stdResource);
boolean removeById(String id);

// ä¸šåŠ¡æŸ¥è¯¢æ–¹æ³•
StdResource getByResourceCode(String resourceCode);
List<StdResource> listByStatus(String standardStatus);
IPage<StdResource> pageByConditions(Page<StdResource> page, StdResource resource);
```

#### é™„ä»¶ç®¡ç†æœåŠ¡
**StdResourceAttachmentService.java**
```java
// æ ¹æ®èµ„æºIDæŸ¥è¯¢é™„ä»¶åˆ—è¡¨
List<StdResourceAttachment> listByResourceId(String resourceId);

// è·å–ä¸»æ–‡ä»¶
StdResourceAttachment getMainFileByResourceId(String resourceId);

// æ–‡ä»¶ä¸Šä¼ å¤„ç†
boolean uploadAttachment(MultipartFile file, String resourceId);
```

### 3. æ§åˆ¶å™¨å±‚ (Controller)

#### RESTful APIè®¾è®¡
**æ ‡å‡†èµ„æºç®¡ç†æ¥å£**
```java
// æŸ¥è¯¢æ¥å£
GET /standard/resource/{id}           - æ ¹æ®IDæŸ¥è¯¢
GET /standard/resource/code/{code}    - æ ¹æ®ç¼–å·æŸ¥è¯¢  
GET /standard/resource/page           - åˆ†é¡µæŸ¥è¯¢
GET /standard/resource/list           - åˆ—è¡¨æŸ¥è¯¢

// æ“ä½œæ¥å£  
POST /standard/resource               - æ–°å¢èµ„æº
PUT /standard/resource/{id}           - æ›´æ–°èµ„æº
DELETE /standard/resource/{id}        - åˆ é™¤èµ„æº
```

#### ç»Ÿä¸€å“åº”æ ¼å¼
```java
// æˆåŠŸå“åº”
return R.ok(data);

// å¤±è´¥å“åº”
return R.fail("æ“ä½œå¤±è´¥", errorCode);

// åˆ†é¡µå“åº”
return R.ok(PageResult.build(page));
```

## ğŸ” æƒé™æ§åˆ¶

### Sa-Tokenæƒé™é…ç½®
```java
// æ§åˆ¶å™¨æƒé™æ³¨è§£
@PreAuthorize("hasPermission('standard:resource:view')")
@SaCheckPermission("standard:resource:edit")

// æ•°æ®æƒé™æ§åˆ¶
@DataScope(deptAlias = "d", userAlias = "u")
```

### æƒé™ç‚¹è®¾è®¡
```
standard:resource:view    - æŸ¥çœ‹æ ‡å‡†èµ„æº
standard:resource:add     - æ–°å¢æ ‡å‡†èµ„æº
standard:resource:edit    - ç¼–è¾‘æ ‡å‡†èµ„æº  
standard:resource:delete  - åˆ é™¤æ ‡å‡†èµ„æº
standard:resource:export  - å¯¼å‡ºæ ‡å‡†èµ„æº
```

## ğŸ“± APIæ¥å£æ–‡æ¡£

### æ¥å£åˆ†ç»„
- **æ ‡å‡†èµ„æºç®¡ç†**: `/standard/resource/**`
- **é™„ä»¶ç®¡ç†**: `/standard/attachment/**`  
- **æœ¯è¯­ç®¡ç†**: `/standard/terminology/**`
- **å¼•ç”¨å…³ç³»**: `/standard/reference/**`
- **è§£è¯»æ–‡æ¡£**: `/standard/interpretation/**`

### æ¥å£ç¤ºä¾‹

#### 1. åˆ†é¡µæŸ¥è¯¢æ ‡å‡†èµ„æº
**è¯·æ±‚**: `GET /standard/resource/page`

**å‚æ•°**:
```json
{
    "pageNum": 1,
    "pageSize": 10,
    "resourceCode": "GB/T",
    "chineseName": "ç–¾ç—…",
    "standardStatus": "ç°è¡Œ",
    "standardField": "åŒ»ç–—"
}
```

**å“åº”**:
```json
{
    "code": 200,
    "message": "æ“ä½œæˆåŠŸ",
    "data": {
        "records": [...],
        "total": 100,
        "pages": 10
    }
}
```

#### 2. æ–°å¢æ ‡å‡†èµ„æº
**è¯·æ±‚**: `POST /standard/resource`

**å‚æ•°**:
```json
{
    "resourceCode": "GB/T 14396-2024",
    "chineseName": "ç–¾ç—…åˆ†ç±»ä¸ä»£ç (2024ç‰ˆ)",
    "standardStatus": "å³å°†å®æ–½",
    "standardType": "å›½å®¶æ ‡å‡†",
    "standardNature": "æ¨èæ€§",
    "publishOrganization": "å›½å®¶å«ç”Ÿå¥åº·å§”å‘˜ä¼š",
    "standardField": "åŒ»ç–—",
    "standardClassification": "åˆ†ç±»ä¸ç¼–ç "
}
```

## ğŸ› ï¸ å¼€å‘è§„èŒƒ

### 1. ä»£ç é£æ ¼
- **å®ä½“ç±»**: ä½¿ç”¨`@Data`ã€`@EqualsAndHashCode(callSuper = true)`
- **Mapperæ¥å£**: ç»§æ‰¿`BaseMapper<T>`ï¼Œè‡ªå®šä¹‰æ–¹æ³•ç”¨`@Param`æ³¨è§£
- **Serviceå®ç°**: ç»§æ‰¿`ServiceImpl<TMapper, T>`ï¼Œå®ç°ä¸šåŠ¡æ¥å£
- **Controller**: ä½¿ç”¨`@RestController`ã€ç»Ÿä¸€è¿”å›`R<T>`ç±»å‹

### 2. å¼‚å¸¸å¤„ç†
```java
// ä¸šåŠ¡å¼‚å¸¸
throw new BusinessException("æ ‡å‡†ç¼–å·å·²å­˜åœ¨");

// å‚æ•°éªŒè¯å¼‚å¸¸  
@Valid @RequestBody StdResourceDTO dto
```

### 3. æ—¥å¿—è®°å½•
```java
// æ“ä½œæ—¥å¿—
@WebLog(description = "æŸ¥è¯¢æ ‡å‡†èµ„æºåˆ—è¡¨")

// æ€§èƒ½ç›‘æ§
@Slf4j - ä½¿ç”¨æ—¥å¿—æ¡†æ¶è®°å½•å…³é”®æ“ä½œ
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•
```java
@SpringBootTest
class StdResourceServiceTest {
    @Test
    void testGetByResourceCode() {
        // æµ‹è¯•æ ¹æ®ç¼–å·æŸ¥è¯¢æ ‡å‡†
    }
    
    @Test  
    void testSaveStdResource() {
        // æµ‹è¯•ä¿å­˜æ ‡å‡†èµ„æº
    }
}
```

### 2. é›†æˆæµ‹è¯•
```java
@AutoConfigureTestDatabase
@Transactional
class StdResourceMapperTest {
    // æµ‹è¯•Mapperå±‚æ•°æ®è®¿é—®
}
```

### 3. APIæµ‹è¯•
ä½¿ç”¨æä¾›çš„`æ ‡å‡†èµ„æºç®¡ç†æ¥å£æµ‹è¯•.http`æ–‡ä»¶è¿›è¡Œæ¥å£æµ‹è¯•ã€‚

## ğŸš€ éƒ¨ç½²é…ç½®

### 1. æ•°æ®åº“é…ç½®
æ‰§è¡Œ`å¼€å‘æ–‡æ¡£/æ ‡å‡†èµ„æºæ¨¡å—/æ ‡å‡†èµ„æºæ¨¡å—-æ•°æ®åº“åˆå§‹åŒ–.sql`è„šæœ¬åˆå§‹åŒ–æ•°æ®è¡¨ã€‚

### 2. æ¨¡å—ä¾èµ–  
åœ¨ä¸»æ¨¡å—`newbie-admin`çš„`pom.xml`ä¸­æ·»åŠ ä¾èµ–:
```xml
<dependency>
    <groupId>com.newbie</groupId>
    <artifactId>newbie-standard</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</dependency>
```

### 3. åŒ…æ‰«æé…ç½®
ç¡®ä¿Spring Bootæ‰«æåˆ°æ ‡å‡†èµ„æºæ¨¡å—çš„åŒ…:
```java
@ComponentScan(basePackages = {"com.newbie"})
@MapperScan("com.newbie.standard.mapper")
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–
- **ç´¢å¼•è®¾è®¡**: é’ˆå¯¹å¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç«‹å¤åˆç´¢å¼•
- **åˆ†é¡µæŸ¥è¯¢**: ä½¿ç”¨MyBatis-Plusåˆ†é¡µæ’ä»¶é¿å…å…¨è¡¨æ‰«æ
- **ç¼“å­˜ç­–ç•¥**: Redisç¼“å­˜çƒ­ç‚¹æ•°æ®

### 2. ä¸šåŠ¡ä¼˜åŒ–
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ–°å¢ã€æ›´æ–°æ“ä½œ
- **å¼‚æ­¥å¤„ç†**: å¤§æ–‡ä»¶ä¸Šä¼ ä½¿ç”¨å¼‚æ­¥å¤„ç†
- **æ•°æ®æƒé™**: åœ¨SQLå±‚é¢è¿›è¡Œæ•°æ®æƒé™è¿‡æ»¤

## ğŸ”§ æ‰©å±•åŠŸèƒ½

### 1. æ–‡ä»¶å­˜å‚¨
- **MinIOé›†æˆ**: æ”¯æŒå¤§æ–‡ä»¶å­˜å‚¨å’Œä¸‹è½½
- **æ–‡ä»¶é¢„è§ˆ**: PDFã€å›¾ç‰‡åœ¨çº¿é¢„è§ˆåŠŸèƒ½  
- **ç‰ˆæœ¬ç®¡ç†**: é™„ä»¶ç‰ˆæœ¬æ§åˆ¶

### 2. å…¨æ–‡æ£€ç´¢
- **Elasticsearché›†æˆ**: æ”¯æŒæ ‡å‡†å†…å®¹å…¨æ–‡æœç´¢
- **æ™ºèƒ½æ¨è**: åŸºäºç”¨æˆ·è¡Œä¸ºçš„æ ‡å‡†æ¨è

### 3. æ•°æ®åŒæ­¥
- **å®šæ—¶ä»»åŠ¡**: å®šæœŸåŒæ­¥å¤–éƒ¨æ ‡å‡†æ•°æ®
- **æ•°æ®æ ¡éªŒ**: æ ‡å‡†æ•°æ®å®Œæ•´æ€§æ£€æŸ¥

## ğŸ“‹ å¾…ä¼˜åŒ–é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**: å¤§æ•°æ®é‡åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
2. **ç¼“å­˜ç­–ç•¥**: Redisç¼“å­˜çƒ­ç‚¹æ•°æ®è®¾è®¡  
3. **æ–‡æ¡£ç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆæ ‡å‡†èµ„æºæŠ¥å‘Š
4. **æ•°æ®åˆ†æ**: æ ‡å‡†ä½¿ç”¨æƒ…å†µç»Ÿè®¡åˆ†æ
5. **ç§»åŠ¨ç«¯é€‚é…**: å“åº”å¼è®¾è®¡ä¼˜åŒ–

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰ç–‘é—®æˆ–éœ€è¦æŠ€æœ¯æ”¯æŒï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- **é¡¹ç›®æ–‡æ¡£**: å‚è€ƒ`CLAUDE.md`é¡¹ç›®æŒ‡å¯¼æ–‡æ¡£
- **APIæ–‡æ¡£**: å¯åŠ¨é¡¹ç›®åè®¿é—®Knife4jæ¥å£æ–‡æ¡£
- **æµ‹è¯•ç”¨ä¾‹**: ä½¿ç”¨é¡¹ç›®æ ¹ç›®å½•çš„`.http`æ–‡ä»¶è¿›è¡Œæ¥å£æµ‹è¯•